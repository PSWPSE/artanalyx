import { AgeGroupCriteria } from '@/types';

// 연령대 구분 기준
export const AGE_GROUPS = {
  infant: { min: 2, max: 4, label: '영유아 (2-4세)' },
  child: { min: 5, max: 7, label: '아동 (5-7세)' },
  elementary: { min: 8, max: 12, label: '초등학생 (8-12세)' }
} as const;

// 파일 업로드 제한
export const FILE_CONSTRAINTS = {
  maxSize: 10 * 1024 * 1024, // 10MB
  allowedTypes: ['image/jpeg', 'image/png', 'image/webp'],
  allowedExtensions: ['.jpg', '.jpeg', '.png', '.webp']
} as const;

// Rate Limiting 설정
export const RATE_LIMITS = {
  maxRequests: parseInt(process.env.RATE_LIMIT_MAX_REQUESTS || '10'),
  windowMs: parseInt(process.env.RATE_LIMIT_WINDOW_MS || '3600000') // 1시간
} as const;

// 연령대별 분석 기준
export const AGE_GROUP_CRITERIA: AgeGroupCriteria[] = [
  {
    ageGroup: 'infant',
    focusAreas: ['대근육/소근육 발달', '색채 인식', '기본 감정 표현', '자유로운 상상력'],
    developmentalMilestones: [
      '선긋기와 원 그리기 능력',
      '색상 구별 및 선호도',
      '가족 구성원 표현',
      '감정 상태 반영'
    ],
    analysisPrompt: `이 그림은 ${AGE_GROUPS.infant.min}-${AGE_GROUPS.infant.max}세 영유아가 그린 작품입니다.
    
    🎯 이 연령대 특성:
    - 처음 그림을 그리기 시작하는 시기
    - 자유롭게 선을 긋고 색을 칠하는 것 자체가 즐거움
    - 손과 눈의 협응력이 발달 중
    - 색깔과 모양에 대한 호기심이 높음
    
    ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
    이 그림을 분석할 때 특별히 관찰해야 할 것들:
    ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
    
    1. 【손 사용 능력과 심리】
       - 선을 어떻게 그었나요? (크게 휘두른 선 vs 작고 조심스러운 선)
         → 큰 동작: 자유롭고 활발한 성격
         → 작은 동작: 조심스럽거나 신중한 성격
       
       - 색칠을 어떻게 했나요?
         → 종이를 넘어서까지 칠함: 자유분방하고 에너지가 많음
         → 조심스럽게 칠함: 신중하거나 통제를 배우는 중
    
    2. 【색상 선택과 감정】
       - 어떤 색을 주로 사용했나요?
         → 밝은 색 위주: 긍정적이고 활발한 정서 상태
         → 어두운 색 위주: 조용하거나, 무언가 불안한 마음이 있을 수 있음
         → 단일 색: 아직 색에 대한 탐색이 시작 단계이거나, 특정 색에 대한 강한 선호
         → 다양한 색: 호기심이 많고 탐구적인 성향
    
    3. 【그림 크기와 공간 활용으로 보는 자신감】
       - 종이 전체를 사용했나요, 한 부분만 사용했나요?
         → 종이 전체 사용: 자신감, 활발함, 주도성
         → 작은 영역만 사용: 아직 탐색 중이거나, 조심스러운 성격
         → 한쪽으로 치우침: 특정한 관심사나 관점
    
    4. 【표현 내용과 인지 발달】
       - 무엇을 그렸나요?
         → 단순한 선과 원: 발달 초기 단계 (정상)
         → 무언가 표현하려는 시도: 상징적 사고의 시작
         → 반복 패턴: 규칙성 인식, 안정감 추구
    
    5. 【필압과 정서 에너지】
       - 얼마나 세게 눌러서 그렸나요?
         → 강한 필압: 에너지가 많고 의욕적이거나, 긴장 상태
         → 약한 필압: 조심스럽거나, 체력적으로 지쳐있을 수 있음
    
    ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
    ⚠️ 반드시 이렇게 분석하세요:
    ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
    
    ❌ "이 나이 아이들은 보통 이렇게 그립니다" (일반론 금지!)
    ✅ "이 그림에서 아이가 빨간색으로 종이 전체에 크게 원을 그린 점은, 자신감 있고 에너지가 넘치는 상태를 보여줍니다"
    
    ❌ "소근육 발달이 이루어지고 있습니다" (추상적 표현 금지!)
    ✅ "이 그림에서 작은 원을 여러 개 그린 것을 보니, 손가락을 조절하는 능력이 발달하고 있고, 이는 집중력과 인내심도 함께 자라고 있다는 의미입니다"
    
    발달 이론(Kellogg, Lowenfeld, Piaget 등)을 언급할 때는 반드시:
    1. 이 그림의 구체적 특징을 먼저 언급하고
    2. 그것이 어떤 심리 상태를 반영하며
    3. 이론은 그것을 뒷받침하는 근거로만 사용하세요
    
    이 연령대는 그림이 단순해 보여도, 그 안에 아이의 성격, 정서 상태, 발달 수준이 모두 담겨 있습니다.
    실제 심리 치료사처럼, 이 그림만이 가진 독특한 특징을 찾아 깊이 있게 해석해주세요.`
  },
  {
    ageGroup: 'child',
    focusAreas: ['형태 인식', '공간 감각', '사회성 표현', '학습 준비도'],
    developmentalMilestones: [
      '인물화의 세부 묘사',
      '배경과 전경 구분',
      '이야기가 있는 그림',
      '규칙과 패턴 이해'
    ],
    analysisPrompt: `이 그림은 ${AGE_GROUPS.child.min}-${AGE_GROUPS.child.max}세 아동이 그린 작품입니다.
    
    🎯 이 연령대 특성:
    - 그림으로 자신의 생각과 이야기를 표현하기 시작
    - 사람, 집, 나무 등을 상징적으로 그릴 수 있음
    - 친구와 가족에 대한 관심이 그림에 나타남
    - 학교 준비 시기로 집중력과 완성도가 중요
    
    ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
    이 그림을 분석할 때 특별히 관찰해야 할 것들:
    ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
    
    1. 【인물화로 보는 자아상과 대인관계】
       - 사람을 그렸나요? 어떻게 그렸나요?
         → 머리만 있고 몸통 생략: 아직 발달 초기 (정상)
         → 머리-몸통-팔다리 구분: 자아 개념 형성 중
         → 손가락, 옷, 머리카락 등 세부 표현: 관찰력과 표현력 발달
         
       - **손과 팔**: 
         → 생략: 대인관계에서의 무력감, 표현의 어려움 가능성
         → 크게 그림: 활동적, 뭔가 하고 싶은 욕구
         → 뒤로 숨김: 수줍음, 소극적 성향
         
       - **얼굴 표정**:
         → 웃는 얼굴: 긍정적 정서
         → 무표정: 감정 표현의 어려움 또는 억제
         → 과장된 표정: 감정 표현 욕구가 강함
         
       - **사람의 크기와 위치**:
         → 종이에 가득 찬 큰 사람: 자신감, 자기 중심성
         → 작은 사람: 위축, 불안, 자신감 부족
         → 여러 명: 사회적 관심, 관계에 대한 인식
    
    2. 【색상과 감정 상태】
       - 어떤 색을 주로 사용했나요?
         → 밝고 다양한 색: 정서적 풍부함, 긍정적 상태
         → 검정/갈색 위주: 불안, 우울, 억압된 감정 가능성
         → 빨강 과다 사용: 에너지 넘침, 때로는 공격성/분노
         → 파랑/보라 위주: 차분함, 내향적, 때로는 우울감
         
       - 색칠 방식:
         → 경계 안에 꼼꼼히: 규칙 준수, 완벽주의 성향
         → 경계 밖으로 넘침: 자유분방함, 충동성
         → 색칠 안 함: 과제 회피, 완성 부담, 또는 단순히 선 그리기 선호
    
    3. 【공간 구성과 심리적 의미】
       - 그림의 위치:
         → 상단: 상상력, 이상 지향, 때로는 현실 도피
         → 중앙: 안정감, 균형 잡힌 심리
         → 하단: 현실 지향, 때로는 불안정감
         → 왼쪽: 과거 지향, 내성적
         → 오른쪽: 미래 지향, 외향적
         
       - 배경 표현:
         → 땅, 하늘 구분: 공간 개념 발달
         → 집, 나무, 꽃 등 배경 요소: 안정감, 풍부한 환경 인식
         → 텅 빈 배경: 고립감, 환경과의 단절 느낌 가능성
    
    4. 【주제 선택과 관심사】
       - 무엇을 그렸나요?
         → 가족: 가족관계에 대한 관심, 소속감
         → 친구들: 또래 관계의 중요성 인식
         → 혼자 있는 자신: 자아 탐색 또는 외로움
         → 집: 안전감, 가정에 대한 생각
         → 자연/동물: 상상력, 순수함, 안정감 추구
         → 전투/괴물: 공격성, 내적 갈등, 또는 단순한 관심사
    
    5. 【완성도와 학습 준비도】
       - 그림을 끝까지 완성했나요?
         → 완성: 과제 집중력, 책임감
         → 미완성: 주의력 문제, 완벽주의에 대한 두려움
         
       - 세부 묘사:
         → 자세함: 관찰력, 인내심, 집중력
         → 단순함: 아직 발달 중이거나, 빠른 성격
    
    6. 【생략과 과장으로 보는 심리】
       - 특별히 크게 그린 부분:
         → 큰 머리: 지적 활동에 대한 관심/스트레스
         → 큰 눈: 경계심, 주변에 대한 민감성
         → 큰 입: 언어 욕구, 표현 욕구
         
       - 생략된 부분:
         → 손: 무력감, 관계의 어려움
         → 발: 불안정감
         → 귀: 듣기 싫은 것, 소통 거부
    
    ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
    ⚠️ 반드시 이렇게 분석하세요:
    ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
    
    ❌ "사회성 발달이 이루어지고 있습니다" (추상적!)
    ✅ "이 그림에서 친구 3명을 함께 그리고, 손을 잡고 있는 모습을 표현한 점은 또래 관계를 중요하게 생각하고, 친구들과의 연결을 원하는 마음을 보여줍니다"
    
    ❌ "인지 발달이 적절합니다" (일반론!)
    ✅ "이 그림에서 땅과 하늘을 구분하고, 집을 왼쪽에 나무를 오른쪽에 배치한 것은 공간 관계를 이해하고 있으며, 계획적으로 그림을 구성할 수 있는 능력이 발달했음을 보여줍니다"
    
    발달 이론을 언급할 때는:
    1. 먼저 그림의 구체적 특징 지적
    2. 그것의 심리적 의미 해석
    3. 이론은 근거로만 간단히 언급
    
    이 연령대는 학교 입학을 앞두고 있어, 자신감, 사회성, 학습 준비도가 매우 중요합니다.
    이 그림이 보여주는 아이만의 특별한 심리 상태를 깊이 있게 분석해주세요.`
  },
  {
    ageGroup: 'elementary',
    focusAreas: ['자아 개념', '학습 능력', '대인 관계', '정체성 형성'],
    developmentalMilestones: [
      '정교한 세부 표현',
      '원근법과 비례 이해',
      '복합적 감정 표현',
      '계획적 구성 능력'
    ],
    analysisPrompt: `이 그림은 ${AGE_GROUPS.elementary.min}-${AGE_GROUPS.elementary.max}세 초등학생이 그린 작품입니다.
    
    🎯 이 연령대 특성:
    - 사실적으로 표현하고 싶어 하는 욕구 증가
    - 학업과 친구 관계가 자존감에 큰 영향
    - 자신만의 스타일과 관심사가 뚜렷해짐
    - 성취와 인정에 대한 욕구가 강함
    
    ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
    이 그림을 분석할 때 특별히 관찰해야 할 것들:
    ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
    
    1. 【자아상과 자존감】
       - 자신을 어떻게 표현했나요?
         → 크고 당당하게: 자신감, 긍정적 자아상
         → 작고 위축되게: 낮은 자존감, 불안
         → 다른 사람보다 작게: 열등감 가능성
         → 다른 사람보다 크게: 우월감 또는 리더십
         
       - 세부 묘사:
         → 자신을 자세히 그림: 자기 인식 높음
         → 대충 그림: 자아 관심 낮음 또는 자존감 문제
         → 자신을 안 그림: 자아 정체성 혼란 가능성
    
    2. 【완성도와 성취 욕구】
       - 그림을 얼마나 정교하게 그렸나요?
         → 매우 정교함: 완벽주의, 높은 성취 욕구
         → 적당히: 균형 잡힌 성격
         → 대충: 과제 회피, 자신감 부족, 또는 빠른 성격
         
       - 지우개 사용 흔적:
         → 많음: 완벽주의, 불안, 자기 비판적
         → 적당함: 건강한 자기 수정
         → 없음: 자신감 또는 무관심
    
    3. 【사회성과 대인관계 심리】
       - 누구를 그렸나요?
         → 친구들: 또래 관계 중요, 소속감 추구
         → 가족: 가족 관계의 중요성, 안정 추구
         → 혼자: 독립성 또는 외로움/고립감
         → 유명인/캐릭터: 동일시 대상, 이상적 자아
         
       - 사람들 간 거리:
         → 가까움: 친밀감, 소속감
         → 멀리 떨어짐: 정서적 거리, 단절감
         → 손 잡음/접촉: 연결 욕구
         
       - 표정과 감정:
         → 밝은 표정: 긍정적 관계
         → 무표정/슬픔: 관계 문제, 외로움
         → 서로 다른 표정: 관계의 복잡성 인식
    
    4. 【주제 선택과 내면 세계】
       - 무엇을 그렸나요?
         → 학교 장면: 학업에 대한 관심/스트레스
         → 스포츠/게임: 경쟁심, 성취 욕구
         → 자연/풍경: 평화 추구, 현실 도피
         → 판타지/상상: 창의력, 현실 불만족
         → 어두운 주제: 내적 갈등, 불안, 우울
    
    5. 【원근법과 구성력으로 보는 인지 발달】
       - 원근법 사용:
         → 사용함: 공간 지각 능력 발달, 논리적 사고
         → 사용 안 함: 아직 발달 중이거나, 표현 의지 부족
         
       - 구도와 배치:
         → 계획적 구성: 조직력, 계획 능력
         → 무계획적: 충동적 또는 자유로운 성격
         → 비대칭: 심리적 불균형 가능성
         → 대칭: 안정감 추구, 완벽주의
    
    6. 【색상과 정서 상태 (더 복잡해진 감정)】
       - 어떤 색을 선택했나요?
         → 다양하고 조화로움: 정서적 안정, 감정 조절 능력
         → 과도하게 밝음: 불안 은폐, 과잉 긍정
         → 어두운 색 위주: 우울, 불안, 억압
         → 공격적 색 (빨강/검정): 분노, 스트레스
         
       - 색 사용의 독창성:
         → 독특한 색 조합: 창의성, 독립적 사고
         → 평범한 색: 순응적, 안전 추구
         → 현실과 다른 색 (파란 나무 등): 상상력 또는 현실 인식 문제
    
    7. 【스트레스와 내적 갈등 신호】
       - 다음 요소들을 주의 깊게 관찰:
         → 과도하게 작은 그림: 위축, 불안
         → 폭력적 내용: 분노, 공격성, 트라우마 가능성
         → 어두운 주제 반복: 우울, 불안
         → 극도로 정교하거나 반복적 패턴: 강박, 불안
         → 성적 요소: 조기 노출 또는 학대 가능성
    
    8. 【학업 스트레스와 성취압력】
       - 그림에 나타난 스트레스 징후:
         → 지우개 과다 사용
         → 미완성
         → "못 그렸다"는 자기 비판적 언급 (있다면)
         → 완벽주의적 세부 묘사
         → 학업 관련 주제
    
    ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
    ⚠️ 반드시 이렇게 분석하세요:
    ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
    
    ❌ "또래 관계가 중요한 시기입니다" (일반론!)
    ✅ "이 그림에서 친구 5명을 원형으로 배치하고, 모두가 서로를 보고 있는 모습은 또래 집단 내에서의 소속감과 상호작용을 중요하게 여기는 마음을 보여줍니다"
    
    ❌ "자존감이 발달하고 있습니다" (추상적!)
    ✅ "이 그림에서 자신을 중앙에 크게 배치하고, 트로피를 들고 있는 모습은 성취에 대한 자부심과 인정받고 싶은 욕구를 나타냅니다. 하지만 얼굴 표정이 없는 점은 성취에도 불구하고 내면의 감정을 표현하는 데 어려움이 있을 수 있음을 시사합니다"
    
    이 연령대는:
    - 학업 스트레스, 또래 관계, 자아 정체성이 복잡하게 얽힌 시기
    - 작은 실패에도 자존감이 크게 흔들릴 수 있음
    - 부모와의 관계도 변화하는 전환기
    
    단순히 발달 단계를 평가하는 것이 아니라, 이 아이가 지금 겪고 있는 심리적 상황과 내면의 갈등, 
    그리고 강점과 회복탄력성을 그림을 통해 깊이 있게 읽어내주세요.`
  }
];

// 에러 메시지
export const ERROR_MESSAGES = {
  FILE_TOO_LARGE: `파일 크기가 너무 큽니다. ${FILE_CONSTRAINTS.maxSize / 1024 / 1024}MB 이하의 파일을 업로드해주세요.`,
  INVALID_FILE_TYPE: '지원하지 않는 파일 형식입니다. JPG, PNG, WEBP 파일만 업로드 가능합니다.',
  RATE_LIMIT_EXCEEDED: '요청 한도를 초과했습니다. 잠시 후 다시 시도해주세요.',
  ANALYSIS_FAILED: '분석 중 오류가 발생했습니다. 다시 시도해주세요.',
  NETWORK_ERROR: '네트워크 오류가 발생했습니다. 인터넷 연결을 확인해주세요.',
  INVALID_AGE: '연령을 올바르게 입력해주세요. (2-12세)',
  UPLOAD_FAILED: '파일 업로드에 실패했습니다. 다시 시도해주세요.'
} as const;

// 성공 메시지
export const SUCCESS_MESSAGES = {
  UPLOAD_SUCCESS: '이미지가 성공적으로 업로드되었습니다.',
  ANALYSIS_COMPLETE: '분석이 완료되었습니다.',
  FILE_PROCESSED: '파일이 처리되었습니다.'
} as const;
